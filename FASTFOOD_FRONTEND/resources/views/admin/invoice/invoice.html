<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>AdminLTE 3 | Invoice</title>

    <!-- Google Font: Source Sans Pro -->
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="../../plugins/fontawesome-free/css/all.min.css">
    <!-- Theme style -->
    <link rel="stylesheet" href="../../dist/css/adminlte.min.css">
</head>

<body class="hold-transition sidebar-mini">
    <div class="wrapper">
        <!-- Navbar -->
        <nav class="main-header navbar navbar-expand navbar-white navbar-light">
            <!-- Left navbar links -->
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
                </li>
                <li class="nav-item d-none d-sm-inline-block">
                    <a href="index3.html" class="nav-link">Home</a>
                </li>
                <li class="nav-item d-none d-sm-inline-block">
                    <a href="#" class="nav-link">Contact</a>
                </li>
            </ul>

            <!-- Right navbar links -->
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link" data-widget="navbar-search" href="#" role="button">
                        <i class="fas fa-search"></i>
                    </a>
                    <div class="navbar-search-block">
                        <form class="form-inline">
                            <div class="input-group input-group-sm">
                                <input class="form-control form-control-navbar" type="search" placeholder="Search"
                                    aria-label="Search">
                                <div class="input-group-append">
                                    <button class="btn btn-navbar" type="submit">
                                        <i class="fas fa-search"></i>
                                    </button>
                                    <button class="btn btn-navbar" type="button" data-widget="navbar-search">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </li>
                <li class="nav-link">
                    <a href="/admin/adminLogout" style="margin-top:5px; box-sizing: box;">Logout</a>
                </li>

            </ul>
        </nav>
        <!-- /.navbar -->

        <!-- Main Sidebar Container -->
        <aside class="main-sidebar sidebar-dark-primary elevation-4">
            <!-- Brand Logo -->
            <a href="index3.html" class="brand-link">
                <img src="../../dist/img/AdminLTELogo.png" alt="AdminLTE Logo" class="brand-image img-circle elevation-3"
                    style="opacity: .8">
                <span class="brand-text font-weight-light">AdminLTE 3</span>
            </a>

            <!-- Sidebar -->
            <div class="sidebar">
                <!-- Sidebar user (optional) -->
                <div class="user-panel mt-3 pb-3 mb-3 d-flex">
                    <div class="image">
                        <img src="../../dist/img/user2-160x160.jpg" class="img-circle elevation-2" alt="User Image">
                    </div>
                    <div class="info">
                        <a href="#" class="d-block">Alexander Pierce</a>
                    </div>
                </div>


                <!-- Sidebar Menu -->
                <aside class="main-sidebar sidebar-dark-primary elevation-4">
                    <!-- Brand Logo -->
                    <a href="/admin" class="brand-link">
                        <img src="../../dist/img/AdminLTELogo.png" alt="AdminLTE Logo"
                            class="brand-image img-circle elevation-3" style="opacity: .8">
                        <span class="brand-text font-weight-light">FastFood</span>
                    </a>

                    <!-- Sidebar -->
                    <div class="sidebar">
                        <!-- Sidebar user panel (optional) -->
                        <div class="user-panel mt-3 pb-3 mb-3 d-flex">
                            <div class="image">
                                <img src="../../dist/img/user2-160x160.jpg" class="img-circle elevation-2" alt="User Image">
                            </div>
                            <div class="info">
                                <a href="/infor" class="d-block">Admin</a>
                            </div>
                        </div>



                        <!-- Sidebar Menu -->
                        <nav class="mt-2">
                            <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu"
                                data-accordion="false">
                                <!-- Add icons to the links using the .nav-icon class
                         with font-awesome or any other icon font library -->


                                <li class="nav-item">
                                    <a href="/admin/category" class="nav-link">
                                        <i class="nav-icon fas fa-th"></i>
                                        <p>
                                            Categories List

                                        </p>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="/admin/product" class="nav-link">
                                        <i class="nav-icon fas fa-th"></i>
                                        <p>
                                            Products
                                        </p>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="/admin/user" class="nav-link">
                                        <i class="nav-icon fas fa-th"></i>
                                        <p>
                                            Users
                                        </p>
                                    </a>
                                </li>


                                <li class="nav-item">
                                    <a href="/admin/customer" class="nav-link">
                                        <i class="nav-icon fas fa-th"></i>
                                        <p>
                                            Customers
                                        </p>
                                    </a>
                                </li>


                                <li class="nav-item">
                                    <a href="/admin/order" class="nav-link">
                                        <i class="nav-icon fas fa-th"></i>
                                        <p>
                                            Orders
                                        </p>
                                    </a>
                                </li>
                            </ul>
                        </nav>
                        <!-- /.sidebar-menu -->
                    </div>
                    <!-- /.sidebar -->
                </aside>
                <!-- /.sidebar-menu -->
            </div>
            <!-- /.sidebar -->
        </aside>

        <!-- Content Wrapper. Contains page content -->
        <div class="content-wrapper">
            <!-- Content Header (Page header) -->
            <section class="content-header">
                <div class="container-fluid">
                    <div class="row mb-2">
                        <div class="col-sm-6">
                            <h1>Invoice</h1>
                        </div>
                        <div class="col-sm-6">
                            <ol class="breadcrumb float-sm-right">
                                <li class="breadcrumb-item"><a href="#">Home</a></li>
                                <li class="breadcrumb-item active">Invoice</li>
                            </ol>
                        </div>
                    </div>
                </div><!-- /.container-fluid -->
            </section>

            <section class="content">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-12">
                            <!-- Main content -->
                            <div class="invoice p-3 mb-3">
                                <!-- title row -->
                                <div class="row">
                                    <div class="col-12">
                                        <h4 id="shop-name">
                                            <i class="fas fa-globe"></i>
                                            <small class="float-right" id="orders-created-at">created at: </small>
                                        </h4>
                                    </div>
                                    <!-- /.col -->
                                </div>
                                <!-- info row -->
                                <div class="row invoice-info">
                                    <div class="col-sm-4 invoice-col">
                                        From
                                        <address id="shop-info">
                                           
                                        </address>
                                    </div>
                                    <!-- /.col -->
                                    <div class="col-sm-4 invoice-col">
                                        To
                                        <address id="customer-info">
                                            
                                        </address>
                                    </div>
                                    <!-- /.col -->
                                    <div class="col-sm-4 invoice-col">
                                        <b id="orders-id">Order ID:</b><br>
                                        <b id="orders-due_date">Payment Due:</b><br>
                                        <b id="orders-status">Status:</b>
                                    </div>
                                    <!-- /.col -->
                                </div>
                                <!-- /.row -->

                                <!-- Table row -->
                                <div class="row">
                                    <div class="col-12 table-responsive">
                                        <table class="table table-striped">
                                            <thead>
                                                <tr>
                                                    <th>Qty</th>
                                                    <th>Product</th>
                                                    <th>Serial #</th>
                                                    <th>Description</th>
                                                    <th>Subtotal</th>
                                                </tr>
                                            </thead>
                                            <tbody id="show-order-products">
                                                <!-- <c:forEach var="item" items="${products}" varStatus="loop">
                                                    <tr>
                                                        <td>item.quantity</td>
                                                        <td>item.product_name</td>
                                                        <td>item.product_description</td>
                                                        <td>item.money</td>
                                                        <th>item.subTotal</th>
                                                    </tr>
                                                </c:forEach> -->
                                            </tbody>
                                        </table>
                                    </div>
                                    <!-- /.col -->
                                </div>
                                <!-- /.row -->

                                <div class="row">
                                    <!-- accepted payments column -->
                                    <div class="col-6">
                                        <p class="lead">Payment Methods:</p>
                                        <img src="../../dist/img/credit/visa.png" alt="Visa">
                                        <img src="../../dist/img/credit/mastercard.png" alt="Mastercard">
                                        <img src="../../dist/img/credit/american-express.png" alt="American Express">
                                        <img src="../../dist/img/credit/paypal2.png" alt="Paypal">

                                        <p class="text-muted well well-sm shadow-none" style="margin-top: 10px;">
                                            Etsy doostang zoodles disqus groupon greplin oooj voxy zoodles,
                                            weebly ning heekya handango imeem
                                            plugg
                                            dopplr jibjab, movity jajah plickers sifteo edmodo ifttt zimbra.
                                        </p>
                                    </div>
                                    <!-- /.col -->
                                    <div class="col-6">
                                        <p class="lead" id="orders-started">Amount Due: </p>

                                        <div class="table-responsive">
                                            <table class="table">
                                                <tr>
                                                    <th style="width:50%">Subtotal:</th>
                                                    <td id="orders-sub_total"></td>
                                                </tr>
                                                <tr>
                                                    <th>Tax (10%)</th>
                                                    <td id="orders-tax"></td>
                                                </tr>
                                                <tr>
                                                    <th>Shipping:</th>
                                                    <td id="shop-shipping">shop.shipping</td>
                                                </tr>
                                                <tr>
                                                    <th>Total:</th>
                                                    <td id="orders-total"></td>
                                                </tr>
                                            </table>
                                        </div>
                                    </div>
                                    <!-- /.col -->
                                </div>
                                <!-- /.row -->

                                <!-- this row will not appear when printing -->

                            </div>
                            <!-- /.invoice -->
                        </div><!-- /.col -->
                    </div><!-- /.row -->
                </div><!-- /.container-fluid -->
            </section>
            <!-- /.content -->
        </div>
        <!-- /.content-wrapper -->
        <footer class="main-footer no-print">
            <div class="float-right d-none d-sm-block">
                <b>Version</b> 3.2.0
            </div>
            <strong>Copyright &copy; 2014-2021 <a href="https://adminlte.io">AdminLTE.io</a>.</strong> All
            rights reserved.
        </footer>

        <!-- Control Sidebar -->
        <aside class="control-sidebar control-sidebar-dark">
            <!-- Control sidebar content goes here -->
        </aside>
        <!-- /.control-sidebar -->
    </div>
    <!-- ./wrapper -->

    <!-- jQuery -->
    <script src="../../plugins/jquery/jquery.min.js"></script>
    <!-- Bootstrap 4 -->
    <script src="../../plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
    <!-- AdminLTE App -->
    <script src="../../dist/js/adminlte.min.js"></script>
    <!-- AdminLTE for demo purposes -->
    <script src="../../dist/js/demo.js"></script>
    <script>
        function get_shop()
        {
            let xhr = new XMLHttpRequest();
            xhr.open("GET","http://localhost:8080/get-shop",true);
            xhr.onload = function()
            {
                let res = JSON.parse(this.responseText);
                document.getElementById("shop-info").innerHTML = "";
                document.getElementById("shop-name").innerHTML += res.name.toUpperCase();
                document.getElementById("shop-shipping").innerHTML = res.shipping;
                htmlString = `
                <strong>${res.name}</strong><br>
                ${res.address}<br>
                ${res.phone}<br>
                ${res.gmail}<br>
                `;
                document.getElementById("shop-info").innerHTML += htmlString;
            }
            xhr.send();
        }
        function get_customer()
        {
            const params = new URLSearchParams(window.location.search);
            const id = params.get('id');
            let data = {
                id: id
            }
            let xhr = new XMLHttpRequest();
            xhr.open("POST","http://localhost:8080/admin/get-customer-orders",true);
            xhr.setRequestHeader("Content-Type","application/json");
            xhr.onload = function()
            {
                let res = JSON.parse(this.responseText);
                document.getElementById("customer-info").innerHTML = "";
                let htmlString = `
                <strong>${res.name}</strong><br>
                    ${res.address}<br>
                    ${res.phone}<br>
                    ${res.gmail}
                `;
                document.getElementById("customer-info").innerHTML += htmlString;
                
            }
            xhr.send(JSON.stringify(data));
        }

        function get_orders()
        {
            const params = new URLSearchParams(window.location.search);
            const id = params.get('id');
            let data = {
                id: id
            }
            let xhr = new XMLHttpRequest();
            xhr.open("POST","http://localhost:8080/admin/get-orders-details",true);
            xhr.setRequestHeader("Content-Type","application/json");
            xhr.onload = function()
            {
                let res = JSON.parse(this.responseText);
                document.getElementById("orders-id").innerHTML+= " " + res.id;
                document.getElementById("orders-due_date").innerHTML += " " + res.due_date;
                let status = "";
                if(res.status == 1)
                {
                    status = "Completed";
                }
                else{
                    status = "Progress";
                }
                document.getElementById("orders-status").innerHTML += " " + status;
                document.getElementById("orders-created-at").innerHTML += " " + res.started_date;
                document.getElementById("orders-started").innerHTML+= " " + res.started_date;
                document.getElementById("orders-sub_total").innerHTML = res.sub_total;
                document.getElementById("orders-tax").innerHTML = res.sub_total*10/100;
                document.getElementById("orders-total").innerHTML =res.sub_total*10/100 + res.sub_total + 300;

            }
            xhr.send(JSON.stringify(data));
        }
        function get_order_products()
        {
            const params = new URLSearchParams(window.location.search);
            const id = params.get('id');
            let data = {
                id: id
            }
            let xhr = new XMLHttpRequest();
            xhr.open("POST","http://localhost:8080/admin/get-order-products",true);
            xhr.setRequestHeader("Content-Type","application/json");
            xhr.onload = function()
            {
                let res = JSON.parse(this.responseText);
                console.log(res);
                document.getElementById("show-order-products").innerHTML = "";
                res.forEach( item => {
                    htmlString = `
                                                    <tr>
                                                        <td>${item.quantity}</td>
                                                        <td>${item.product_name}</td>
                                                        <td>${item.product_id}</td>
                                                        <td>${item.description.substring(0, 50)}</td>
                                                        <td>${item.sub_total}</td>
                                                    </tr>
                    `;
                    document.getElementById("show-order-products").innerHTML += htmlString;
                });
            }
            xhr.send(JSON.stringify(data));
        }
        window.onload = function() {
            get_shop();
            get_customer();
            get_orders();
            get_order_products();
        }
    </script>
</body>

</html>